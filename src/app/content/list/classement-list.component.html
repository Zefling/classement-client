<h2>{{ 'menu.list' | translate }}</h2>
<div class="infos">
    <p>{{ 'list.intro' | translate }}</p>
    <button class="primary" (click)="dialogImport.open()">
        {{ 'gererator.actions.import.json' | translate }}
    </button>
</div>

<table *ngIf="result?.length; else noResult">
    <thead>
        <tr>
            <th class="title">{{ 'list.title.name' | translate }}</th>
            <th class="category">{{ 'list.category.name' | translate }}</th>
            <th class="date">{{ 'list.date' | translate }}</th>
            <th class="groups">{{ 'list.count.group' | translate }}</th>
            <th class="items">{{ 'list.count.item' | translate }}</th>
            <th class="actions">{{ 'list.action.name' | translate }}</th>
        </tr>
    </thead>
    <tbody>
        <tr *ngFor="let item of result">
            <td class="title">{{ item.options.title || ('list.title.undefined' | translate) }}</td>
            <td class="category">{{ 'category.' + (item.options.category || 'undefined') | translate }}</td>
            <td class="date">
                <span>{{ item.date | date: ('date.dd/MM/yyyy' | translate) }}</span>
                <span>{{ item.date | date: ('date.HH:mm' | translate) }}</span>
            </td>
            <td class="groups">{{ item.groupsLenght }}</td>
            <td class="items">{{ item.listLenght }}</td>
            <td class="actions">
                <a [routerLink]="'/edit/' + item.id">{{ 'list.action.edit' | translate }}</a>
                <a (click)="delete(item)">{{ 'list.action.delete' | translate }}</a>
                <a (click)="clone(item)">{{ 'list.action.clone' | translate }}</a>
            </td>
        </tr>
    </tbody>
</table>

<ng-template #noResult>
    <p class="no-result">{{ 'list.no.result' | translate }}</p>
    <p>
        <a routerLink="/edit/new" routerLinkActive="active">{{ 'list.create.new' | translate }}</a>
    </p>
</ng-template>

<dialog-cmp #dialogImport class="auto-format">
    <import-json (load)="importJson($event)" actions="importOnly"></import-json>
</dialog-cmp>

<dialog-cmp #dialogDelete class="auto-format dialog-delete">
    <p>{{ 'list.delete.question' | translate }}</p>
    <p class="title">{{ itemCurrent?.options?.title || ('list.title.undefined' | translate) }}</p>
    <div>
        <button (click)="deleteCurrent(false)">{{ 'list.delete.cancel' | translate }}</button>
        <button class="warn" (click)="deleteCurrent(true)">{{ 'list.delete.validate' | translate }}</button>
    </div>
</dialog-cmp>

<dialog-cmp #dialogClone class="auto-format dialog-clone">
    <p>{{ 'list.clone.question' | translate }}</p>
    <p class="title">{{ itemCurrent?.options?.title || ('list.title.undefined' | translate) }}</p>
    <div>
        <label>{{ 'list.clone.title' | translate }}</label>
        <div><input type="text" maxlength="150" [value]="itemCurrent?.options?.title" #title /></div>
    </div>
    <div>
        <button (click)="cloneCurrent(false)">{{ 'list.clone.cancel' | translate }}</button>
        <button class="primary" (click)="cloneCurrent(true, title.value)">
            {{ 'list.clone.validate' | translate }}
        </button>
        <button class="primary" (click)="cloneCurrent(true, title.value, true)">
            {{ 'list.clone.edit' | translate }}
        </button>
    </div>
</dialog-cmp>
